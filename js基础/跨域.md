什么情况下算跨域
非同源请求，均为跨域。
同源 —— 如果两个页面拥有相同的协议，端口和 IP，那么这两个页面就属于同一个源。

解决跨域的方式：
https://juejin.im/post/5815f4abbf22ec006893b431

1. JSONP
   通过 script 标签引入的 js 是不受同源策略的限制的。
   实现方式：通过 script 标签发起一个请求，（回调函数的名称方在请求的参数里），服务器返回回调函数的执行
   ，并将响应的数据放到回调函数的参数里，当前端请求到这个回调函数时，会立即执行，就能拿到服务端响应的数据。

      <script type="text/javascript">
          function dosomething(jsondata){
              //处理获得的json数据
        }
      </script>
      <script src="http://example.com/data.php?callback=dosomething"></script>

   优点：兼容性好，
   缺点：只支持 GET 请求

2. CORS
   允许浏览器向跨域服务器发出 XMLHttpRequest 请求，它需要浏览器和服务器同时支持。

   （1）浏览器端需要向请求头添加 origin 字段，表明当前请求来源。
   （2）服务器端需要设置响应头的 Access-Control-Allow-Methods，Access-Control-Allow-Headers，Access-Control-Allow-Origin 等字段，指定允许的方法，头部，源等信息。
   （3）请求分为简单请求和非简单请求，非简单请求会先进行一次 potion 方法进行预检

简单请求： HEAD,GET,POST

请求头信息字段：
Accept
Accept-Language
Content-Langeuage
Last-Event-ID
Content-Type:(application/x-www-form-urlencoded、multipart/form-data、text/plain)

后端的响应头信息：
Access-Control-Allow-Origin

非简单请求：
对服务端有特殊操作的请求，比如 PUT,DELETE,请求，content-Type 为 application/json 的，在正式通信之前会增加一次预检请求
如果预检失败会返回一个正常的 http,没有请求头，浏览器会捕获错误

优点：支持所有类型的 HTTP 请求，方便可靠，比 JSONP 有更好的错误处理
缺点：老版本的浏览器兼容问题

3. postMessage
   window.postMessage 方法是 html5 的新特性，可以使用它来向其他的 window 对象发送消息，无论这个 window 对象同不同源

   A 页面通过 postMessage 方法发送消息：
   otherWindow.postMessage("hello",targetOrigin)
   B 页面通过 message 事件监听并接受消息：
   var onmessage = function (event) {  
    var data = event.d ata;//消息  
    var origin = event.origin;//消息来源地址  
    var source = event.source;//源 Window 对象  
    if(origin=="http://www.baidu.com"){  
    console.log(data);//hello  
    }  
    };
   window.addEventListener('message', onmessage, false);

4. loacation.hash + iframe
   借助父窗口域名下的一个代理 iframe，来修改 parent.location.hash 的值
   A 页面修改 iframe 的 src，B 也页面监听 url 变化，触发相应操作。

5. document.domain+iframe

6. window.name+iframe

7. nginx 反向代理
